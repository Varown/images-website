{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Result","styled","div","H1","h1","Image","img","Input","input","Dragger","Upload","Uploader","observer","useStores","ImageStore","UserStore","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","ref1","useRef","ref2","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","test","type","size","error","upload","then","console","log","catch","tip","spinning","isUpoading","className","InboxOutlined","href","filename","target","src","ref","onChange","current","value","placeholder","fullStr","StyledTips","Tips","children","Home"],"mappings":"mqBASA,IAAMA,EAASC,IAAOC,IAAV,KAKNC,EAAKF,IAAOG,GAAV,KAIFC,EAAQJ,IAAOK,IAAV,KAILC,EAAQN,IAAOO,MAAV,KAOHC,EAAYC,IAAZD,QA6HOE,EA3HCC,aAAS,WAAK,IAAD,EAGMC,cAAzBC,EAHmB,EAGnBA,WAAWC,EAHQ,EAGRA,UACZC,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAkBF,EAAME,OAAQ,IAEzCE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAmBJ,EAAMI,QAAS,IAE3C,cAEE,OAAON,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAMrGC,EAAOC,mBACPC,EAAOD,mBAYPE,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACC,OAA1BrB,EAAUsB,aACXC,IAAQC,QAAQ,qDACT,GAGJ,wCAAwCC,KAAKP,EAAKQ,MAInDR,EAAKS,KAAO,SACdJ,IAAQK,MAAM,+BACP,IAET7B,EAAW8B,SACRC,MAAK,SAACvB,GACLwB,QAAQC,IAAI,4BACZD,QAAQC,IAAIzB,MACX0B,OAAM,WACTF,QAAQC,IAAI,gCAEP,IAdLT,IAAQK,MAAM,0EACP,KAiBb,OACE,6BACE,kBAAC,IAAD,CAAMM,IAAI,qBAAMC,SAAUpC,EAAWqC,YACrC,kBAAC1C,EAAYqB,EACX,uBAAGsB,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,gEACA,uBAAGA,UAAU,mBAAb,yGAMAtC,EAAWQ,WAAa,kBAACtB,EAAD,KACtB,kBAACG,EAAD,iCACA,4BACE,yDACA,4BAAI,uBAAImD,KAAMxC,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,KAAOV,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,MACrH,kDACA,4BAAKV,EAAWyC,UAChB,wDACA,4BACE,kBAAClD,EAAD,CAAOmD,OAAO,SAASC,IAAK3C,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,OAE9E,wDACA,4BACE,kBAACjB,EAAD,CAAOmD,IAAK/B,EAAMgC,SAlER,WACnB3C,EAAMG,SAASQ,EAAKiC,QAAQC,QAiE0BC,YAAY,qDACzD,kBAACvD,EAAD,CAAOmD,IAAK7B,EAAM8B,SA/DP,WACrB3C,EAAMK,UAAUQ,EAAK+B,QAAQC,QA8D2BC,YAAY,sDAE5D,qEAGD,4BACE,uBAAGN,OAAO,SAASF,KAAMtC,EAAM+C,SAAU/C,EAAM+C,YAIzC,S,0KCrInB,IAAMC,EAAa/D,IAAOC,IAAV,KAiBD+D,EAVJrD,aAAS,YAAe,IAAbsD,EAAY,EAAZA,SACbnD,EAAWF,cAAXE,UACP,OACE,kBAACiD,EAAD,KAEIjD,EAAUsB,YAAY,KAAK,iCAAO6B,OCF3BC,UAVH,WAEV,OACE,oCACE,kBAAC,EAAD,sDACA,kBAAC,EAAD","file":"static/js/10.70f2ab47.chunk.js","sourcesContent":["import React,{useRef} from 'react';\r\nimport { useStores } from '../stores';\r\nimport { observer ,useLocalStore} from 'mobx-react';\r\nimport { Upload, message,Spin} from 'antd';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport styled from 'styled-components';\r\n\r\n\r\n\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  border: 1px dashed #ccc;\r\n  padding: 20px;\r\n`;\r\nconst H1 = styled.h1`\r\n  margin: 20px 0;\r\n  text-align: center;\r\n`;\r\nconst Image = styled.img`\r\n  max-width: 300px;\r\n`;\r\n\r\nconst Input = styled.input`\r\nmargin-top: 5px;\r\n  margin-right: 10px;\r\n  border-radius: 4px;\r\n`;\r\n\r\n\r\nconst { Dragger } = Upload;\r\n\r\n const Uploader=observer(()=>{\r\n\r\n\r\n  const { ImageStore,UserStore } = useStores();\r\n   const store = useLocalStore(() => ({\r\n     width: null,\r\n     setWidth(width) {\r\n       store.width = width;\r\n     },\r\n     get widthStr() {\r\n       return store.width?`/w/${store.width}`:'';\r\n     },\r\n     height: null,\r\n     setHeight(height) {\r\n       store.height = height;\r\n     },\r\n     get heightStr() {\r\n       return store.height?`/h/${store.height}`:'';\r\n     },\r\n     get fullStr() {\r\n       //?imageView2/0/w/800/h/400)\r\n       return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n     }\r\n\r\n   }));\r\n\r\n\r\n  const ref1 = useRef();\r\n  const ref2 = useRef();\r\n\r\n  const bindWidthChange=()=>{\r\n     store.setWidth(ref1.current.value)\r\n\r\n  }\r\n  const bindHeightChange=()=>{\r\n    store.setHeight(ref2.current.value)\r\n\r\n  }\r\n\r\n\r\n  const props = {\r\n    showUploadList: false,\r\n    beforeUpload: file => {\r\n      ImageStore.setFile(file);\r\n      ImageStore.setFilename(file.name);\r\n      if(UserStore.currentUser === null) {\r\n        message.warning('请先登录再上传！');\r\n        return false;\r\n      }\r\n\r\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\r\n        message.error('只能上传png/svg/jpg/gif格式的图片');\r\n        return false;\r\n      }\r\n      if (file.size > 1024 * 1024) {\r\n        message.error('图片最大1M');\r\n        return false;\r\n      }\r\n      ImageStore.upload()\r\n        .then((serverFile) => {\r\n          console.log('上传成功')\r\n          console.log(serverFile);\r\n        }).catch(() => {\r\n        console.log('上传失败')\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return(\r\n    <div>\r\n      <Spin tip=\"上传中\" spinning={ImageStore.isUpoading} >\r\n      <Dragger {...props}>\r\n        <p className=\"ant-upload-drag-icon\">\r\n          <InboxOutlined />\r\n        </p>\r\n        <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\r\n        <p className=\"ant-upload-hint\">\r\n          仅支持.png/.gif/.jpg/.svg格式的图片，图片最大1M\r\n        </p>\r\n      </Dragger>\r\n      </Spin>\r\n      {\r\n        ImageStore.serverFile ? <Result>\r\n          <H1>上传结果</H1>\r\n          <dl>\r\n            <dt>线上地址:</dt>\r\n            <dd><a  href={ImageStore.serverFile.attributes.url.attributes.url}>{ ImageStore.serverFile.attributes.url.attributes.url}</a></dd>\r\n            <dt>文件名</dt>\r\n            <dd>{ImageStore.filename}</dd>\r\n            <dt>图片预览</dt>\r\n            <dd>\r\n              <Image target='_blank' src={ImageStore.serverFile.attributes.url.attributes.url}/>\r\n            </dd>\r\n            <dt>更多尺寸</dt>\r\n            <dd>\r\n              <Input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\"/>\r\n              <Input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>\r\n            </dd>\r\n            <dt>\r\n              修改后的地址:\r\n            </dt>\r\n           <dd>\r\n             <a target='_blank' href={store.fullStr}>{store.fullStr}</a>\r\n           </dd>\r\n\r\n          </dl>\r\n        </Result> :null\r\n\r\n\r\n\r\n\r\n      }\r\n    </div>\r\n  )\r\n\r\n\r\n\r\n})\r\n\r\n\r\n\r\n\r\nexport default Uploader","import React from 'react';\r\nimport {useStores} from \"../stores\";\r\nimport { observer } from 'mobx-react';\r\nimport styled from 'styled-components';\r\n\r\nconst StyledTips = styled.div`\r\n  background: orange;\r\n  padding: 10px;\r\n  margin: 30px 0;\r\n  color: #fff;\r\n  border-radius: 4px;\r\n`;\r\nconst Tips=observer(({children})=>{\r\n  const {UserStore}=useStores()\r\n  return(\r\n    <StyledTips>\r\n      {\r\n        UserStore.currentUser?null:<div> {children}</div>\r\n      }\r\n    </StyledTips>\r\n  )\r\n})\r\nexport default Tips","import React from 'react';\r\n\r\nimport Uploader from '../components/Uploader';\r\nimport Tips from '../components/Tips';\r\n\r\nconst Home =( )=> {\r\n\r\n  return (\r\n    <>\r\n      <Tips>请先登录再上传!!!</Tips>\r\n      <Uploader />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Home;"],"sourceRoot":""}